import{u as T}from"./useAsyncValidator-C5NemhNH.js";import{d,a3 as z,f as G,x as H,A as J,D as K,o as L,a as Q,h as a,i as o,u as e,j as h,t as p,a8 as P,O as y,b as f}from"./index-uPjlTW5-.js";import{_ as B,a as _,b as X,c as S}from"./Form.layout.vue_vue_type_script_setup_true_lang-B3guF2JO.js";import{_ as Y}from"./Form.input.vue_vue_type_script_setup_true_lang-BBQUoBof.js";import{_ as Z}from"./Form.textarea.vue_vue_type_script_setup_true_lang-BYw8y6gU.js";import{_ as ee}from"./TableView.vue_vue_type_script_setup_true_lang-DGus58nM.js";import{_ as D}from"./Form.radio.vue_vue_type_script_setup_true_lang-DqVl4uhi.js";import{p as $,r as te,a as ae,h as ie,b as ne}from"./prescription.table-CvpvBTP9.js";import{i as oe,p as j}from"./prescription-5aEF9qJt.js";import{g as k,p as N}from"./request.helper-Dd_ZrsNF.js";import{r as se}from"./util.object-9m6X7yey.js";import{v as re}from"./v4-CQkTLCs1.js";import{f as A}from"./index-NXitLOah.js";import"./form-DgPV59gJ.js";import"./keyboard-j6qjsN5K.js";import"./EyeIcon-S74RYEFz.js";import"./menu-CtMGN0OX.js";import"./use-tree-walker-DJqhipSi.js";import"./open-closed-CQLd4LBk.js";import"./CheckIcon-B7uHx4cQ.js";import"./EyeIcon-1Lg2I0N_.js";import"./ChevronRightIcon-CpK7bIX2.js";import"./vi-C2Rev4gY.js";import"./formatDistance-BTOIJc1i.js";import"./ChevronDownIcon-CXEVS-NP.js";import"./util.number-CuqvV8jo.js";import"./_plugin-vue_export-helper-DlAUqK2U.js";import"./enum-CD4clsnU.js";const F={prescriptionId:"-1",usage:"",medicineId:"-1",quantity:1},M={doctorId:"-1",patientId:"-1"},l=d({...F}),b=d({...M}),I=d([]),C=d([]),U=d([]),g=d(""),w=d(""),le=d({}),de=d({}),V=d({...oe}),E=async()=>{const u={...j.value,value:g.value};k("/api/medicines/page",u).then(i=>{if(i!=null&&i.data){const{data:s,...t}=i.data;I.value=s,le.value=t}})},R=async u=>{g.value=u;const i={...j.value,value:g.value};k("/api/users/role/customer/search",i).then(s=>{if(s!=null&&s.data){const{data:t,...v}=s.data;C.value=t,de.value=v}})},pe=()=>{var i;const u=(i=I.value)==null?void 0:i.find(s=>s.id===l.value.medicineId);l.value.medicine=u,U.value.push(l.value),l.value=F},ue=async u=>{const i=re(),s={...b.value,id:i,doctorId:u};await N("/api/prescriptions",s).then(t=>{t!=null&&t.data&&(z(t.message),se(b,M))}),U.value.forEach(async t=>{t.prescriptionId=i,await N("/api/prescriptiondetails",t)})},me=A(async()=>{await E()},600,{maxWait:5e3}),ce=A(async()=>{await R(g.value)},600,{maxWait:5e3}),fe={class:"flex flex-col gap-10"},ge={class:"flex flex-wrap items-center justify-end gap-3.5"},he={type:"button",class:"inline-flex items-center gap-2.5 rounded bg-transparent px-4 py-2 font-medium text-green-600 border border-green-600 hover:bg-opacity-90"},be={class:"inline-flex items-center gap-2.5 rounded bg-green-600 px-4 py-2 font-medium text-white hover:bg-opacity-90"},ve=["disabled"],Je=G({__name:"PrescriptionAddView",setup(u){const i=H(),{user:s}=J(),{pass:t,errorFields:v}=T(b,ne),W=async()=>{await ue(s.id)};return K(async()=>{await E(),await R(String(i.query.email))}),(r,n)=>(L(),Q("div",fe,[a(S,{submit:e(pe)},{default:o(()=>[a(B,null,{default:o(()=>{var m,x,q,O;return[a(_,{"has-error":[!!((x=(m=e(v))==null?void 0:m.medicineId)!=null&&x.length)]},{heading:o(()=>[h(p(r.$t("form.medicine")),1)]),content:o(()=>[a(D,P({"onUpdate:search":[e(me),n[1]||(n[1]=c=>y(w)?w.value=c:null)],id:e(l).medicineId,"onUpdate:id":n[0]||(n[0]=c=>e(l).medicineId=c),search:e(w),list:e(I)},{pagination:e(V),paginationOptions:e($)}),null,16,["onUpdate:search","id","search","list"])]),_:1},8,["has-error"]),a(_,{"has-error":[!!((O=(q=e(v))==null?void 0:q.patientId)!=null&&O.length)]},{heading:o(()=>[h(p(r.$t("form.customer")),1)]),content:o(()=>[a(D,P({"onUpdate:search":[e(ce),n[3]||(n[3]=c=>y(g)?g.value=c:null)],id:e(b).patientId,"onUpdate:id":n[2]||(n[2]=c=>e(b).patientId=c),search:e(g),list:e(C)},{pagination:e(V),paginationOptions:e($)}),null,16,["onUpdate:search","id","search","list"])]),_:1},8,["has-error"])]}),_:1}),a(B,null,{default:o(()=>[a(X,{modelValue:e(t),"onUpdate:modelValue":n[4]||(n[4]=m=>y(t)?t.value=m:null),pass:!0},null,8,["modelValue"]),a(_,{"has-error":[!1]},{heading:o(()=>[h(p(r.$t("form.content")),1)]),content:o(()=>[a(Y,{modelValue:e(l).quantity,"onUpdate:modelValue":n[5]||(n[5]=m=>e(l).quantity=m),type:"number",placeholder:r.$t("form.place_holder.quantity")},{default:o(()=>[h(p(r.$t("form.quantity")),1)]),_:1},8,["modelValue","placeholder"]),a(Z,{modelValue:e(l).usage,"onUpdate:modelValue":n[6]||(n[6]=m=>e(l).usage=m),"has-error":!1,placeholder:r.$t("form.place_holder.usage")},{default:o(()=>[h(p(r.$t("form.usage")),1)]),_:1},8,["modelValue","placeholder"])]),_:1})]),_:1})]),_:1},8,["submit"]),a(S,{submit:W},{default:o(()=>[a(_,{"has-error":[e(t)],class:"col-span-2"},{heading:o(()=>[h(p(r.$t("content.prescription")),1)]),content:o(()=>[f("div",ge,[f("button",he,[a(e(te),{class:"w-5 h-5"}),f("span",null,p(r.$t("button.save_as",{name:"PDF"})),1)]),f("button",be,[a(e(ae),{class:"w-5 h-5"}),f("span",null,p(r.$t("button.print")),1)]),f("button",{type:"submit",disabled:!e(t),class:"inline-flex items-center gap-2.5 rounded bg-cerulean-600 px-4 py-2 font-medium text-white hover:bg-opacity-90 disabled:bg-cerulean-300"},[f("span",null,p(r.$t("button.submit")),1)],8,ve)]),a(ee,{headers:e(ie),items:e(U),pagination:e(V),"pagination-options":e($),fetch:async()=>{},route:"pre",key:"pre"},null,8,["headers","items","pagination","pagination-options"])]),_:1},8,["has-error"])]),_:1})]))}});export{Je as default};
